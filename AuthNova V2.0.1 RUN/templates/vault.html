{% extends "base.html" %}
{% block content %}
<div class="card">
    <h2>Your Vault</h2>

    {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
            {% for category, message in messages %}
                <div class="alert alert-{{ category }}">{{ message }}</div>
            {% endfor %}
        {% endif %}
    {% endwith %}

    <form id="vault-form" class="vault-form" method="post" action="{{ url_for('add_entry') }}">
        <input type="hidden" name="csrf_token" id="csrf_token" value="{{ csrf_token() }}">
        <div class="form-group">
            <input type="text" id="label" name="label" placeholder="Label (e.g., Gmail)" required />
        </div>
        <div class="form-group">
            <input type="text" id="username" name="username" placeholder="Username" required />
        </div>
        <div class="form-group">
            <input type="password" id="password" name="password" placeholder="Password" required />
        </div>
        <div class="form-group">
            <input type="email" id="email" name="email" placeholder="Email (optional)" />
        </div>
        <button type="submit" class="btn">Add Entry</button>
    </form>
</div>

<div class="card mt-4">
    <h3>Stored Credentials</h3>
    <div class="vault-entries">
        {% if entries %}
            {% for entry in entries %}
                <div class="vault-entry" data-label="{{ entry.label|e }}">
                    <div class="entry-left">
                        <h4>{{ entry.label|e }}</h4>
                        <div class="entry-meta">
                            {% if entry.username %}
                                <div>Username: <strong>{{ entry.username|e }}</strong></div>
                            {% endif %}
                            {% if entry.email %}
                                <div>Email: <strong>{{ entry.email|e }}</strong></div>
                            {% endif %}
                            {% if entry.password %}
                                <div>Password: <code class="entry-password">{{ entry.password|e }}</code></div>
                            {% endif %}
                        </div>
                    </div>
                    <div class="entry-actions">
                        <button type="button" class="delete-entry-btn delete-btn" data-label="{{ entry.label|e }}">Delete</button>
                    </div>
                </div>
            {% endfor %}
        {% else %}
            <p class="no-entries">No entries in vault yet.</p>
        {% endif %}
    </div>
</div>
{% endblock %}