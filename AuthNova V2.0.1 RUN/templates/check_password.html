{% extends "base.html" %}
{% block title %}Check Password{% endblock %}

{% block content %}
<div class="form-container">
  <h2>Check Password</h2>
  <form method="post" action="{{ url_for('check_password') }}" id="check-password-form">
    <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
    <div class="form-group">
      <label for="check-password">Password to check</label>
      <input type="password" id="check-password" name="password" required>
    </div>
    <button type="submit" class="btn">Check Password</button>
  </form>

  {% if has_result %}
    {% if error %}
      <div class="breach-box">
        <strong>Unable to check</strong>
        <div class="meta">{{ error }}</div>
      </div>
    {% else %}
      {% if count is none %}
        <div class="breach-box">
          <strong>Service unavailable</strong>
          <div class="meta">The breach-check service is temporarily unavailable.</div>
        </div>
      {% elif count == 0 %}
        <div class="safe-box">
          <strong>No breaches found</strong>
          <div class="meta">This password was not found in known breach lists.</div>
        </div>
      {% else %}
        <div class="breach-box" role="alert" aria-live="polite">
          <strong>Password exposed</strong>
          <div class="meta">This password was found in {{ count }} breach{{ 'es' if count != 1 else '' }}.</div>
        </div>
      {% endif %}
    {% endif %}
  {% endif %}
</div>
{% endblock %}